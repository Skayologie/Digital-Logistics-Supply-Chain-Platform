{
  "version": "1.0",
  "records": [
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/controller/WarehouseController.java",
      "timestamp": 1763116225897,
      "startOffset": 1066,
      "endOffset": 1115,
      "codeContent": "    @RoleRequired({\"ADMIN\",\"WAREHOUSE_MANAGER\"})\n",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 2
    },
    {
      "filePath": "/RoleAspect.java",
      "timestamp": 1763116266262,
      "startOffset": 1381,
      "endOffset": 1401,
      "codeContent": "IntellijIdeaRulezzz ",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/aspects/RoleAspect.java",
      "timestamp": 1763116276925,
      "startOffset": 1386,
      "endOffset": 1410,
      "codeContent": "Missing or invalid token",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "/WarehouseController.java",
      "timestamp": 1763116569596,
      "startOffset": 1071,
      "endOffset": 1120,
      "codeContent": "RoleRequired({\"ADMIN\",\"WAREHOUSE_MANAGER\"})\n    @",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 2
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116603388,
      "startOffset": 642,
      "endOffset": 691,
      "codeContent": "    @RoleRequired({\"ADMIN\",\"WAREHOUSE_MANAGER\"})\n",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 2
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116603410,
      "startOffset": 647,
      "endOffset": 683,
      "codeContent": "com.project.supplychain.annotations.",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116603428,
      "startOffset": 107,
      "endOffset": 163,
      "codeContent": "import com.project.supplychain.annotations.RoleRequired;",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116608881,
      "startOffset": 651,
      "endOffset": 700,
      "codeContent": "    @RoleRequired({\"ADMIN\",\"WAREHOUSE_MANAGER\"})\n",
      "aiProbability": 70,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 2
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116608913,
      "startOffset": 656,
      "endOffset": 692,
      "codeContent": "com.project.supplychain.annotations.",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116608928,
      "startOffset": 107,
      "endOffset": 163,
      "codeContent": "import com.project.supplychain.annotations.RoleRequired;",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116609702,
      "startOffset": 712,
      "endOffset": 748,
      "codeContent": "com.project.supplychain.annotations.",
      "aiProbability": 70,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116612231,
      "startOffset": 878,
      "endOffset": 914,
      "codeContent": "com.project.supplychain.annotations.",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116612254,
      "startOffset": 107,
      "endOffset": 163,
      "codeContent": "import com.project.supplychain.annotations.RoleRequired;",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116627193,
      "startOffset": 2483,
      "endOffset": 2519,
      "codeContent": "com.project.supplychain.annotations.",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/main/java/com/project/supplychain/services/WarehouseService.java",
      "timestamp": 1763116627207,
      "startOffset": 107,
      "endOffset": 163,
      "codeContent": "import com.project.supplychain.annotations.RoleRequired;",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/InventoryMovementServiceTest.java",
      "timestamp": 1763308233958,
      "startOffset": 1256,
      "endOffset": 2067,
      "codeContent": "    void createInbound_appliesQtyToInventory() {\n        InventoryMovementDTO dto \u003d new InventoryMovementDTO();\n    dto.setType(MovementType.INBOUND);\n    dto.setQuantity(5);\n    UUID invId \u003d UUID.randomUUID();\n    dto.setInventoryId(invId);\n\n        Inventory inv \u003d new Inventory();\n        inv.setId(invId);\n        inv.setQtyOnHand(10);\n\n        InventoryMovement movement \u003d new InventoryMovement();\n        movement.setId(UUID.randomUUID());\n\n        when(inventoryRepository.findById(invId)).thenReturn(Optional.of(inv));\n        when(inventoryMovementMapper.toEntity(dto)).thenReturn(movement);\n        when(inventoryMovementRepository.save(any(InventoryMovement.class))).thenReturn(movement);\n\n        var res \u003d inventoryMovementService.create(dto);\n        assertThat(res).containsKey(\"message\");\n    }\n",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 22
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/InventoryMovementServiceTest.java",
      "timestamp": 1763308534194,
      "startOffset": 1256,
      "endOffset": 2067,
      "codeContent": "    void createInbound_appliesQtyToInventory() {\n        InventoryMovementDTO dto \u003d new InventoryMovementDTO();\n    dto.setType(MovementType.INBOUND);\n    dto.setQuantity(5);\n    UUID invId \u003d UUID.randomUUID();\n    dto.setInventoryId(invId);\n\n        Inventory inv \u003d new Inventory();\n        inv.setId(invId);\n        inv.setQtyOnHand(10);\n\n        InventoryMovement movement \u003d new InventoryMovement();\n        movement.setId(UUID.randomUUID());\n\n        when(inventoryRepository.findById(invId)).thenReturn(Optional.of(inv));\n        when(inventoryMovementMapper.toEntity(dto)).thenReturn(movement);\n        when(inventoryMovementRepository.save(any(InventoryMovement.class))).thenReturn(movement);\n\n        var res \u003d inventoryMovementService.create(dto);\n        assertThat(res).containsKey(\"message\");\n    }\n",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 22
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/InventoryMovementServiceTest.java",
      "timestamp": 1763309108786,
      "startOffset": 1246,
      "endOffset": 2132,
      "codeContent": "    @Test\n    void createInbound_appliesQtyToInventory() {\n        InventoryMovementDTO dto \u003d new InventoryMovementDTO();\n        dto.setType(MovementType.INBOUND);\n        dto.setQuantity(5);\n        UUID invId \u003d UUID.randomUUID();\n        dto.setInventoryId(invId);\n\n        Inventory inv \u003d new Inventory();\n        inv.setId(invId);\n        inv.setQtyOnHand(10);\n\n        InventoryMovement movement \u003d new InventoryMovement();\n        movement.setId(UUID.randomUUID());\n        movement.setQuantity(dto.getQuantity());\n\n        when(inventoryRepository.findById(invId)).thenReturn(Optional.of(inv));\n        when(inventoryMovementMapper.toEntity(dto)).thenReturn(movement);\n        when(inventoryMovementRepository.save(any(InventoryMovement.class))).thenReturn(movement);\n\n        var res \u003d inventoryMovementService.create(dto);\n        assertThat(res).containsKey(\"message\");\n    }\n",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 24
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763309334612,
      "startOffset": 146,
      "endOffset": 498,
      "codeContent": "(properties \u003d {\n    \"spring.datasource.url\u003djdbc:h2:mem:testdb;DB_CLOSE_DELAY\u003d-1;DB_CLOSE_ON_EXIT\u003dFALSE\",\n    \"spring.datasource.driver-class-name\u003dorg.h2.Driver\",\n    \"spring.datasource.username\u003dsa\",\n    \"spring.datasource.password\u003d\",\n    \"spring.jpa.database-platform\u003dorg.hibernate.dialect.H2Dialect\",\n    \"spring.jpa.hibernate.ddl-auto\u003dcreate-drop\"\n})",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 8
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763310064849,
      "startOffset": 130,
      "endOffset": 576,
      "codeContent": "\n@SpringBootTest(properties \u003d {\n    \"spring.datasource.url\u003djdbc:h2:mem:testdb;DB_CLOSE_DELAY\u003d-1;DB_CLOSE_ON_EXIT\u003dFALSE\",\n    \"spring.datasource.driver-class-name\u003dorg.h2.Driver\",\n    \"spring.datasource.username\u003dsa\",\n    \"spring.datasource.password\u003d\",\n    \"spring.jpa.database-platform\u003dorg.hibernate.dialect.H2Dialect\",\n    \"spring.jpa.properties.hibernate.dialect\u003dorg.hibernate.dialect.H2Dialect\",\n    \"spring.jpa.hibernate.ddl-auto\u003dcreate-drop\"\n}",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 10
    },
    {
      "filePath": "/InventoryMovementServiceTest.java",
      "timestamp": 1763310213691,
      "startOffset": 876,
      "endOffset": 896,
      "codeContent": "IntellijIdeaRulezzz ",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/InventoryMovementServiceTest.java",
      "timestamp": 1763310217310,
      "startOffset": 876,
      "endOffset": 909,
      "codeContent": "org.springframework.test.context.",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/InventoryMovementServiceTest.java",
      "timestamp": 1763310217322,
      "startOffset": 675,
      "endOffset": 730,
      "codeContent": "import org.springframework.test.context.ActiveProfiles;",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763310278355,
      "startOffset": 133,
      "endOffset": 153,
      "codeContent": "IntellijIdeaRulezzz ",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763310284157,
      "startOffset": 132,
      "endOffset": 165,
      "codeContent": "org.springframework.test.context.",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763310284167,
      "startOffset": 129,
      "endOffset": 184,
      "codeContent": "import org.springframework.test.context.ActiveProfiles;",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 1
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763310899179,
      "startOffset": 130,
      "endOffset": 186,
      "codeContent": "import org.springframework.test.context.ActiveProfiles;\n",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 2
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/SalesOrderLineServiceTest.java",
      "timestamp": 1763314369680,
      "startOffset": 50,
      "endOffset": 7862,
      "codeContent": "com.project.supplychain.DTOs.salesOrderLineDTOs.SalesOrderLineDTO;\nimport com.project.supplychain.exceptions.BadRequestException;\nimport com.project.supplychain.mappers.SalesOrderLineMapper;\nimport com.project.supplychain.models.*;\nimport com.project.supplychain.repositories.*;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.ArgumentCaptor;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.math.BigDecimal;\nimport java.util.List;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass SalesOrderLineServiceTest {\n\n    @Mock\n    private SalesOrderLineRepository salesOrderLineRepository;\n\n    @Mock\n    private SalesOrderRepository salesOrderRepository;\n\n    @Mock\n    private ProductRepository productRepository;\n\n    @Mock\n    private InventoryRepository inventoryRepository;\n\n    @Mock\n    private InventoryMovementRepository inventoryMovementRepository;\n\n    @Mock\n    private SalesOrderLineMapper mapper;\n\n    @InjectMocks\n    private SalesOrderLineService service;\n\n    @Test\n    void create_fullReserve_reservesAndReturnsDto() {\n        UUID soId \u003d UUID.randomUUID();\n        UUID productId \u003d UUID.randomUUID();\n\n        SalesOrderLineDTO dto \u003d SalesOrderLineDTO.builder()\n                .salesOrderId(soId)\n                .productId(productId)\n                .quantity(3)\n                .build();\n\n        SalesOrder so \u003d new SalesOrder();\n        so.setId(soId);\n        Warehouse wh \u003d new Warehouse();\n        wh.setId(UUID.randomUUID());\n        so.setWarehouse(wh);\n\n        Product product \u003d new Product();\n        product.setId(productId);\n\n        Inventory inv \u003d new Inventory();\n        inv.setId(UUID.randomUUID());\n        inv.setProduct(product);\n        inv.setWarehouse(wh);\n        inv.setQtyOnHand(10);\n        inv.setQtyReserved(1);\n\n        SalesOrderLine entity \u003d new SalesOrderLine();\n        entity.setQuantity(3);\n\n        SalesOrderLine saved \u003d new SalesOrderLine();\n        saved.setId(UUID.randomUUID());\n        saved.setQuantity(3);\n\n        when(salesOrderRepository.findById(soId)).thenReturn(Optional.of(so));\n        when(productRepository.findById(productId)).thenReturn(Optional.of(product));\n        when(inventoryRepository.getByQtyOnHandGreaterThanAndProduct(0, product)).thenReturn(List.of(inv));\n        when(mapper.toEntity(dto)).thenReturn(entity);\n        when(salesOrderLineRepository.save(entity)).thenReturn(saved);\n        when(mapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d service.create(dto);\n\n        assertThat(res).containsKey(\"message\");\n        assertThat(res.get(\"salesOrderLine\")).isEqualTo(dto);\n\n        // qtyReserved should have been incremented by 3 -\u003e was 1 now 4\n        ArgumentCaptor\u003cInventory\u003e cap \u003d ArgumentCaptor.forClass(Inventory.class);\n        verify(inventoryRepository).save(cap.capture());\n        Inventory captured \u003d cap.getValue();\n        assertThat(captured.getQtyReserved()).isEqualTo(4);\n    }\n\n    @Test\n    void create_noInventory_throws() {\n        UUID soId \u003d UUID.randomUUID();\n        UUID productId \u003d UUID.randomUUID();\n\n        SalesOrderLineDTO dto \u003d SalesOrderLineDTO.builder()\n                .salesOrderId(soId)\n                .productId(productId)\n                .quantity(2)\n                .build();\n\n        SalesOrder so \u003d new SalesOrder();\n        so.setId(soId);\n        Warehouse wh \u003d new Warehouse();\n        wh.setId(UUID.randomUUID());\n        so.setWarehouse(wh);\n\n        Product product \u003d new Product();\n        product.setId(productId);\n\n        when(salesOrderRepository.findById(soId)).thenReturn(Optional.of(so));\n        when(productRepository.findById(productId)).thenReturn(Optional.of(product));\n        when(inventoryRepository.getByQtyOnHandGreaterThanAndProduct(0, product)).thenReturn(List.of());\n\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"No inventory available\");\n    }\n\n    @Test\n    void update_adjustsReservations_whenWasReserved_andCanReserveNew() {\n        UUID lineId \u003d UUID.randomUUID();\n        UUID productId \u003d UUID.randomUUID();\n\n        SalesOrderLine existing \u003d new SalesOrderLine();\n        existing.setId(lineId);\n        existing.setQuantity(2);\n        existing.setBackorder(false);\n\n        SalesOrder so \u003d new SalesOrder();\n        so.setId(UUID.randomUUID());\n        Warehouse wh \u003d new Warehouse(); wh.setId(UUID.randomUUID()); so.setWarehouse(wh);\n        existing.setSalesOrder(so);\n\n        Product oldProduct \u003d new Product(); oldProduct.setId(UUID.randomUUID()); existing.setProduct(oldProduct);\n\n        // old inventory\n        Inventory oldInv \u003d new Inventory(); oldInv.setProduct(oldProduct); oldInv.setWarehouse(wh); oldInv.setQtyReserved(5);\n\n        // new product + inventory\n        Product newProduct \u003d new Product(); newProduct.setId(productId);\n        Inventory newInv \u003d new Inventory(); newInv.setProduct(newProduct); newInv.setWarehouse(wh); newInv.setQtyOnHand(10); newInv.setQtyReserved(1);\n\n        SalesOrderLineDTO dto \u003d SalesOrderLineDTO.builder().quantity(3).productId(productId).build();\n\n        when(salesOrderLineRepository.findById(lineId)).thenReturn(Optional.of(existing));\n        when(productRepository.findById(productId)).thenReturn(Optional.of(newProduct));\n        when(inventoryRepository.findByProduct_IdAndWarehouse_Id(oldProduct.getId(), wh.getId())).thenReturn(Optional.of(oldInv));\n        when(inventoryRepository.findByProduct_IdAndWarehouse_Id(newProduct.getId(), wh.getId())).thenReturn(Optional.of(newInv));\n        when(salesOrderLineRepository.save(existing)).thenReturn(existing);\n        when(mapper.toDTO(existing)).thenReturn(dto);\n\n        var res \u003d service.update(lineId, dto);\n\n        assertThat(res).containsKey(\"message\");\n        assertThat(res.get(\"message\")).isEqualTo(\"Sales order line updated and reserved\");\n\n        // oldInv reserved decreased by oldQty (2) -\u003e was 5 now 3\n        verify(inventoryRepository).save(oldInv);\n        assertThat(oldInv.getQtyReserved()).isEqualTo(3);\n\n        // newInv reserved increased by newQty (3) -\u003e was 1 now 4\n        verify(inventoryRepository, atLeastOnce()).save(newInv);\n        assertThat(newInv.getQtyReserved()).isEqualTo(4);\n    }\n\n    @Test\n    void delete_adjustsReservation_andDeletes() {\n        UUID lineId \u003d UUID.randomUUID();\n\n        SalesOrderLine existing \u003d new SalesOrderLine();\n        existing.setId(lineId);\n        existing.setQuantity(2);\n        existing.setBackorder(false);\n\n        SalesOrder so \u003d new SalesOrder();\n        Warehouse wh \u003d new Warehouse(); wh.setId(UUID.randomUUID()); so.setWarehouse(wh);\n        existing.setSalesOrder(so);\n\n        Product p \u003d new Product(); p.setId(UUID.randomUUID()); existing.setProduct(p);\n\n        Inventory inv \u003d new Inventory(); inv.setProduct(p); inv.setWarehouse(wh); inv.setQtyReserved(5);\n\n        when(salesOrderLineRepository.findById(lineId)).thenReturn(Optional.of(existing));\n        when(inventoryRepository.findByProduct_IdAndWarehouse_Id(p.getId(), wh.getId())).thenReturn(Optional.of(inv));\n\n        var res \u003d service.delete(lineId);\n\n        assertThat(res).containsEntry(\"message\", \"Sales order line deleted and reservation adjusted\");\n        // reservation reduced by 2 -\u003e 5 -\u003e 3\n        verify(inventoryRepository).save(inv);\n        verify(salesOrderLineRepository).delete(existing);\n        assertThat(inv.getQtyReserved()).isEqualTo(3);\n    }\n}\npackage com.project.supplychain.services;\n\nimport ",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 205
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/PurchaseOrderServiceTest.java",
      "timestamp": 1763314820498,
      "startOffset": 146,
      "endOffset": 6463,
      "codeContent": "enums.PurchaseOrderStatus;\nimport com.project.supplychain.exceptions.BadRequestException;\nimport com.project.supplychain.mappers.PurchaseOrderLineMapper;\nimport com.project.supplychain.mappers.PurchaseOrderMapper;\nimport com.project.supplychain.models.*;\nimport com.project.supplychain.models.user.WarehouseManager;\nimport com.project.supplychain.repositories.PurchaseOrderRepository;\nimport com.project.supplychain.repositories.SupplierRepository;\nimport com.project.supplychain.repositories.UserRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.time.LocalDateTime;\nimport java.util.List;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass PurchaseOrderServiceTest {\n\n    @Mock\n    private PurchaseOrderRepository purchaseOrderRepository;\n\n    @Mock\n    private SupplierRepository supplierRepository;\n\n    @Mock\n    private UserRepository userRepository;\n\n    @Mock\n    private PurchaseOrderMapper purchaseOrderMapper;\n\n    @Mock\n    private PurchaseOrderLineMapper purchaseOrderLineMapper;\n\n    @Mock\n    private InventoryMovementService inventoryMovementService;\n\n    @InjectMocks\n    private PurchaseOrderService service;\n\n    @Test\n    void create_success_setsDefaultsAndReturnsDto() {\n        UUID supplierId \u003d UUID.randomUUID();\n        UUID wmId \u003d UUID.randomUUID();\n\n        PurchaseOrderDTO dto \u003d PurchaseOrderDTO.builder()\n                .supplierId(supplierId)\n                .warehouseManagerId(wmId)\n                .expectedDelivery(LocalDateTime.now().plusDays(1))\n                .build();\n\n        Supplier supplier \u003d new Supplier(); supplier.setId(supplierId);\n        WarehouseManager wm \u003d new WarehouseManager(); wm.setId(wmId);\n\n        PurchaseOrder poEntity \u003d new PurchaseOrder();\n        poEntity.setExpectedDelivery(dto.getExpectedDelivery());\n\n        PurchaseOrder saved \u003d new PurchaseOrder(); saved.setId(UUID.randomUUID()); saved.setStatus(PurchaseOrderStatus.CREATED);\n\n        when(supplierRepository.findById(supplierId)).thenReturn(Optional.of(supplier));\n        when(userRepository.findById(wmId)).thenReturn(Optional.of(wm));\n        when(purchaseOrderMapper.toEntity(dto)).thenReturn(poEntity);\n        when(purchaseOrderRepository.save(poEntity)).thenReturn(saved);\n        when(purchaseOrderMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d service.create(dto);\n\n        assertThat(res).containsEntry(\"message\", \"Purchase order created successfully\");\n        assertThat(res).containsKey(\"purchaseOrder\");\n    }\n\n    @Test\n    void create_supplierNotFound_throws() {\n        UUID supplierId \u003d UUID.randomUUID();\n        UUID wmId \u003d UUID.randomUUID();\n        PurchaseOrderDTO dto \u003d PurchaseOrderDTO.builder().supplierId(supplierId).warehouseManagerId(wmId).build();\n        when(supplierRepository.findById(supplierId)).thenReturn(Optional.empty());\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Supplier not found\");\n    }\n\n    @Test\n    void create_userNotWarehouseManager_throws() {\n        UUID supplierId \u003d UUID.randomUUID();\n        UUID wmId \u003d UUID.randomUUID();\n        PurchaseOrderDTO dto \u003d PurchaseOrderDTO.builder().supplierId(supplierId).warehouseManagerId(wmId).build();\n        Supplier supplier \u003d new Supplier(); supplier.setId(supplierId);\n        User user \u003d new User(); user.setId(wmId);\n        when(supplierRepository.findById(supplierId)).thenReturn(Optional.of(supplier));\n        when(userRepository.findById(wmId)).thenReturn(Optional.of(user));\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Provided user is not a WarehouseManager\");\n    }\n\n    @Test\n    void approve_transitionsFromCreatedToApproved() {\n        UUID id \u003d UUID.randomUUID();\n        PurchaseOrder po \u003d new PurchaseOrder(); po.setId(id); po.setStatus(PurchaseOrderStatus.CREATED);\n        when(purchaseOrderRepository.findById(id)).thenReturn(Optional.of(po));\n        when(purchaseOrderRepository.save(po)).thenReturn(po);\n\n        var res \u003d service.approve(id);\n        assertThat(res).containsEntry(\"message\", \"Purchase order approved\");\n    }\n\n    @Test\n    void receive_callsInventoryMovement_andMarksReceived() {\n        UUID id \u003d UUID.randomUUID();\n        PurchaseOrder po \u003d new PurchaseOrder(); po.setId(id); po.setStatus(PurchaseOrderStatus.APPROVED);\n        PurchaseOrderLine line \u003d new PurchaseOrderLine();\n        Inventory inv \u003d new Inventory(); inv.setId(UUID.randomUUID()); line.setInventory(inv); line.setQuantity(2);\n        po.setPurchaseOrderLines(List.of(line));\n\n        when(purchaseOrderRepository.findById(id)).thenReturn(Optional.of(po));\n        when(purchaseOrderRepository.save(po)).thenReturn(po);\n\n        var res \u003d service.receive(id);\n\n        verify(inventoryMovementService).create(any());\n        assertThat(res).containsEntry(\"message\", \"Purchase order received\");\n    }\n\n    @Test\n    void update_whenReceived_throws() {\n        UUID id \u003d UUID.randomUUID();\n        PurchaseOrder po \u003d new PurchaseOrder(); po.setId(id); po.setStatus(PurchaseOrderStatus.RECEIVED);\n        when(purchaseOrderRepository.findById(id)).thenReturn(Optional.of(po));\n        PurchaseOrderDTO dto \u003d new PurchaseOrderDTO();\n        assertThatThrownBy(() -\u003e service.update(id, dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Cannot update a received\");\n    }\n\n    @Test\n    void delete_whenReceived_throws() {\n        UUID id \u003d UUID.randomUUID();\n        PurchaseOrder po \u003d new PurchaseOrder(); po.setId(id); po.setStatus(PurchaseOrderStatus.RECEIVED);\n        when(purchaseOrderRepository.findById(id)).thenReturn(Optional.of(po));\n        assertThatThrownBy(() -\u003e service.delete(id)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Cannot delete a received\");\n    }\n}\npackage com.project.supplychain.services;\n\nimport com.project.supplychain.DTOs.purchaseOrderDTOs.PurchaseOrderDTO;\nimport com.project.supplychain.",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 149
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/ShipmentServiceTest.java",
      "timestamp": 1763315000761,
      "startOffset": 50,
      "endOffset": 5044,
      "codeContent": "com.project.supplychain.DTOs.shipmentDTOs.ShipmentDTO;\nimport com.project.supplychain.enums.OrderStatus;\nimport com.project.supplychain.enums.ShipmentStatus;\nimport com.project.supplychain.exceptions.BadRequestException;\nimport com.project.supplychain.mappers.ShipmentMapper;\nimport com.project.supplychain.models.Carrier;\nimport com.project.supplychain.models.SalesOrder;\nimport com.project.supplychain.models.Shipment;\nimport com.project.supplychain.repositories.CarrierRepository;\nimport com.project.supplychain.repositories.SalesOrderRepository;\nimport com.project.supplychain.repositories.ShipmentRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.time.LocalDateTime;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass ShipmentServiceTest {\n\n    @Mock\n    private ShipmentRepository shipmentRepository;\n\n    @Mock\n    private SalesOrderRepository salesOrderRepository;\n\n    @Mock\n    private CarrierRepository carrierRepository;\n\n    @Mock\n    private ShipmentMapper shipmentMapper;\n\n    @Mock\n    private CarrierService carrierService;\n\n    @InjectMocks\n    private ShipmentService service;\n\n    @Test\n    void create_success_returnsDto() {\n        UUID soId \u003d UUID.randomUUID();\n        UUID carrierId \u003d UUID.randomUUID();\n\n        ShipmentDTO dto \u003d ShipmentDTO.builder().salesOrderId(soId).carrierId(carrierId).trackingNumber(\"T123\").build();\n\n        SalesOrder so \u003d new SalesOrder(); so.setId(soId);\n        Carrier carrier \u003d new Carrier(); carrier.setId(carrierId);\n\n        Shipment entity \u003d new Shipment();\n        Shipment saved \u003d new Shipment(); saved.setId(UUID.randomUUID());\n\n        when(salesOrderRepository.findById(soId)).thenReturn(Optional.of(so));\n        when(carrierRepository.findById(carrierId)).thenReturn(Optional.of(carrier));\n        when(shipmentMapper.toEntity(dto)).thenReturn(entity);\n        when(shipmentRepository.save(entity)).thenReturn(saved);\n        when(shipmentMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d service.create(dto);\n        assertThat(res).containsEntry(\"message\", \"Shipment created successfully\");\n    }\n\n    @Test\n    void ship_success_marksInTransit_andIncrementsCarrier() {\n        UUID id \u003d UUID.randomUUID();\n        Shipment s \u003d new Shipment(); s.setId(id); s.setStatus(ShipmentStatus.PLANNED);\n        Carrier carrier \u003d new Carrier(); carrier.setId(UUID.randomUUID()); carrier.setStatus(null);\n        s.setCarrier(carrier);\n        SalesOrder so \u003d new SalesOrder(); so.setId(UUID.randomUUID()); s.setSalesOrder(so);\n\n        when(shipmentRepository.findById(id)).thenReturn(Optional.of(s));\n        when(shipmentRepository.save(s)).thenReturn(s);\n\n        doNothing().when(carrierService).ensureCanShip(carrier);\n        doNothing().when(carrierService).incrementDailyShipments(carrier);\n\n        var res \u003d service.ship(id);\n\n        verify(carrierService).ensureCanShip(carrier);\n        verify(carrierService).incrementDailyShipments(carrier);\n        verify(salesOrderRepository).save(so);\n        assertThat(res).containsEntry(\"message\", \"Shipment marked as IN_TRANSIT\");\n    }\n\n    @Test\n    void ship_noCarrier_throws() {\n        UUID id \u003d UUID.randomUUID();\n        Shipment s \u003d new Shipment(); s.setId(id); s.setStatus(ShipmentStatus.PLANNED); s.setCarrier(null);\n        when(shipmentRepository.findById(id)).thenReturn(Optional.of(s));\n        assertThatThrownBy(() -\u003e service.ship(id)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Shipment has no carrier assigned\");\n    }\n\n    @Test\n    void deliver_success_marksDelivered() {\n        UUID id \u003d UUID.randomUUID();\n        Shipment s \u003d new Shipment(); s.setId(id); s.setStatus(ShipmentStatus.IN_TRANSIT);\n        SalesOrder so \u003d new SalesOrder(); so.setId(UUID.randomUUID()); s.setSalesOrder(so);\n        when(shipmentRepository.findById(id)).thenReturn(Optional.of(s));\n        when(shipmentRepository.save(s)).thenReturn(s);\n\n        var res \u003d service.deliver(id);\n\n        verify(salesOrderRepository).save(so);\n        assertThat(res).containsEntry(\"message\", \"Shipment marked as DELIVERED\");\n    }\n\n    @Test\n    void update_notPlanned_throws() {\n        UUID id \u003d UUID.randomUUID();\n        Shipment s \u003d new Shipment(); s.setId(id); s.setStatus(ShipmentStatus.IN_TRANSIT);\n        when(shipmentRepository.findById(id)).thenReturn(Optional.of(s));\n        ShipmentDTO dto \u003d new ShipmentDTO();\n        assertThatThrownBy(() -\u003e service.update(id, dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Only PLANNED shipments can be updated\");\n    }\n}\npackage com.project.supplychain.services;\n\nimport ",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 126
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/SupplierServiceTest.java",
      "timestamp": 1763315045892,
      "startOffset": 50,
      "endOffset": 3483,
      "codeContent": "com.project.supplychain.DTOs.supplierDTOs.SupplierDTO;\nimport com.project.supplychain.mappers.SupplierMapper;\nimport com.project.supplychain.models.Supplier;\nimport com.project.supplychain.repositories.SupplierRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.util.List;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass SupplierServiceTest {\n\n    @Mock\n    private SupplierRepository supplierRepository;\n\n    @Mock\n    private SupplierMapper supplierMapper;\n\n    @InjectMocks\n    private SupplierService supplierService;\n\n    @Test\n    void createSupplier_success_returnsDto() {\n        SupplierDTO dto \u003d new SupplierDTO(); dto.setName(\"S1\");\n        Supplier entity \u003d new Supplier();\n        Supplier saved \u003d new Supplier(); saved.setId(UUID.randomUUID()); saved.setName(\"S1\");\n\n        when(supplierMapper.toEntity(dto)).thenReturn(entity);\n        when(supplierRepository.save(entity)).thenReturn(saved);\n        when(supplierMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d supplierService.createSupplier(dto);\n        assertThat(res).containsKey(\"message\");\n        assertThat(res.get(\"supplier\")).isEqualTo(dto);\n    }\n\n    @Test\n    void getSupplier_notFound_throws() {\n        UUID id \u003d UUID.randomUUID();\n        when(supplierRepository.findById(id)).thenReturn(Optional.empty());\n        assertThatThrownBy(() -\u003e supplierService.getSupplier(id)).isInstanceOf(RuntimeException.class);\n    }\n\n    @Test\n    void listSuppliers_returnsList() {\n        Supplier s \u003d new Supplier(); s.setId(UUID.randomUUID()); s.setName(\"S\");\n        SupplierDTO dto \u003d new SupplierDTO(); dto.setName(\"S\");\n        when(supplierRepository.findAll()).thenReturn(List.of(s));\n        when(supplierMapper.toDTO(s)).thenReturn(dto);\n\n        var res \u003d supplierService.listSuppliers();\n        assertThat(res).containsKey(\"suppliers\");\n    }\n\n    @Test\n    void updateSupplier_success_updatesAndReturns() {\n        UUID id \u003d UUID.randomUUID();\n        Supplier existing \u003d new Supplier(); existing.setId(id); existing.setName(\"Old\");\n        SupplierDTO dto \u003d new SupplierDTO(); dto.setName(\"New\"); dto.setContactInfo(\"C\");\n        Supplier saved \u003d new Supplier(); saved.setId(id); saved.setName(\"New\"); saved.setContactInfo(\"C\");\n\n        when(supplierRepository.findById(id)).thenReturn(Optional.of(existing));\n        when(supplierRepository.save(existing)).thenReturn(saved);\n        when(supplierMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d supplierService.updateSupplier(id, dto);\n        assertThat(res).containsEntry(\"message\", \"Supplier updated successfully\");\n        assertThat(res.get(\"supplier\")).isEqualTo(dto);\n    }\n\n    @Test\n    void deleteSupplier_success_deletes() {\n        UUID id \u003d UUID.randomUUID();\n        Supplier existing \u003d new Supplier(); existing.setId(id);\n        when(supplierRepository.findById(id)).thenReturn(Optional.of(existing));\n\n        var res \u003d supplierService.deleteSupplier(id);\n        assertThat(res).containsEntry(\"message\", \"Supplier deleted successfully\");\n        verify(supplierRepository).delete(existing",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 88
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/WarehouseServiceTest.java",
      "timestamp": 1763315318869,
      "startOffset": 50,
      "endOffset": 3494,
      "codeContent": "com.project.supplychain.DTOs.warehouseDTOs.WarehouseDTO;\nimport com.project.supplychain.exceptions.BadRequestException;\nimport com.project.supplychain.mappers.WarehouseMapper;\nimport com.project.supplychain.models.Warehouse;\nimport com.project.supplychain.models.user.WarehouseManager;\nimport com.project.supplychain.repositories.UserRepository;\nimport com.project.supplychain.repositories.WarehouseRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass WarehouseServiceTest {\n\n    @Mock\n    private WarehouseRepository warehouseRepository;\n\n    @Mock\n    private UserRepository userRepository;\n\n    @Mock\n    private WarehouseMapper warehouseMapper;\n\n    @InjectMocks\n    private WarehouseService service;\n\n    @Test\n    void create_success_savesAndReturnsDto() {\n        UUID mgrId \u003d UUID.randomUUID();\n        WarehouseDTO dto \u003d new WarehouseDTO(); dto.setCode(\"W1\"); dto.setName(\"W\"); dto.setWarehouseManagerId(mgrId);\n\n        WarehouseManager mgr \u003d new WarehouseManager(); mgr.setId(mgrId);\n        Warehouse entity \u003d new Warehouse();\n        Warehouse saved \u003d new Warehouse(); saved.setId(UUID.randomUUID());\n\n        when(userRepository.findById(mgrId)).thenReturn(Optional.of(mgr));\n        when(warehouseRepository.existsByCode(dto.getCode())).thenReturn(false);\n        when(warehouseMapper.toEntity(dto)).thenReturn(entity);\n        when(warehouseRepository.save(entity)).thenReturn(saved);\n        when(warehouseMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d service.create(dto);\n        assertThat(res).containsKey(\"message\");\n        assertThat(res.get(\"warehouse\")).isEqualTo(dto);\n        verify(userRepository).save(mgr);\n    }\n\n    @Test\n    void create_missingManager_throws() {\n        WarehouseDTO dto \u003d new WarehouseDTO(); dto.setCode(\"W1\"); dto.setName(\"W\"); dto.setWarehouseManagerId(null);\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"warehouse manager is required\");\n    }\n\n    @Test\n    void create_duplicateCode_throws() {\n        UUID mgrId \u003d UUID.randomUUID();\n        WarehouseDTO dto \u003d new WarehouseDTO(); dto.setCode(\"W1\"); dto.setWarehouseManagerId(mgrId);\n        WarehouseManager mgr \u003d new WarehouseManager(); mgr.setId(mgrId);\n        when(userRepository.findById(mgrId)).thenReturn(Optional.of(mgr));\n        when(warehouseRepository.existsByCode(dto.getCode())).thenReturn(true);\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"warehouse code is already exist\");\n    }\n\n    @Test\n    void delete_existing_deletesSuccessfully() {\n        UUID id \u003d UUID.randomUUID();\n        Warehouse existing \u003d new Warehouse(); existing.setId(id);\n        when(warehouseRepository.findById(id)).thenReturn(Optional.of(existing));\n        var res \u003d service.delete(id);\n        assertThat(res).containsEntry(\"message\", \"Warehouse deleted successfully\");\n        verify(warehouseRepository).delete(existing);\n    }\n}\npackage com.project.supplychain.services;\n\nimport ",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 85
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/InventoryServiceTest.java",
      "timestamp": 1763315364094,
      "startOffset": 353,
      "endOffset": 4566,
      "codeContent": "models.Warehouse;\nimport com.project.supplychain.repositories.InventoryRepository;\nimport com.project.supplychain.repositories.ProductRepository;\nimport com.project.supplychain.repositories.WarehouseRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass InventoryServiceTest {\n\n    @Mock\n    private InventoryRepository inventoryRepository;\n\n    @Mock\n    private ProductRepository productRepository;\n\n    @Mock\n    private WarehouseRepository warehouseRepository;\n\n    @Mock\n    private InventoryMapper inventoryMapper;\n\n    @InjectMocks\n    private InventoryService service;\n\n    @Test\n    void create_success_returnsDto() {\n        UUID productId \u003d UUID.randomUUID();\n        UUID warehouseId \u003d UUID.randomUUID();\n        InventoryDTO dto \u003d new InventoryDTO(); dto.setProductId(productId); dto.setWarehouseId(warehouseId); dto.setQtyOnHand(10); dto.setQtyReserved(2);\n\n        Product p \u003d new Product(); p.setId(productId);\n        Warehouse w \u003d new Warehouse(); w.setId(warehouseId);\n        Inventory entity \u003d new Inventory();\n        Inventory saved \u003d new Inventory(); saved.setId(UUID.randomUUID()); saved.setQtyOnHand(10); saved.setQtyReserved(2);\n\n        when(productRepository.findById(productId)).thenReturn(Optional.of(p));\n        when(warehouseRepository.findById(warehouseId)).thenReturn(Optional.of(w));\n        when(inventoryMapper.toEntity(dto)).thenReturn(entity);\n        when(inventoryRepository.save(entity)).thenReturn(saved);\n        when(inventoryMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d service.create(dto);\n        assertThat(res).containsKey(\"message\");\n        assertThat(res.get(\"inventory\")).isEqualTo(dto);\n    }\n\n    @Test\n    void create_invalidQuantities_throws() {\n        InventoryDTO dto \u003d new InventoryDTO(); dto.setQtyOnHand(1); dto.setQtyReserved(5);\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"qtyReserved cannot exceed qtyOnHand\");\n    }\n\n    @Test\n    void get_notFound_throws() {\n        UUID id \u003d UUID.randomUUID();\n        when(inventoryRepository.findById(id)).thenReturn(Optional.empty());\n        assertThatThrownBy(() -\u003e service.get(id)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Inventory not found\");\n    }\n\n    @Test\n    void update_changesProductAndWarehouse_andSaves() {\n        UUID id \u003d UUID.randomUUID();\n        UUID newProductId \u003d UUID.randomUUID();\n        UUID newWarehouseId \u003d UUID.randomUUID();\n\n        Inventory existing \u003d new Inventory(); existing.setId(id); existing.setQtyOnHand(10); existing.setQtyReserved(2);\n        InventoryDTO dto \u003d new InventoryDTO(); dto.setQtyOnHand(7); dto.setQtyReserved(1); dto.setProductId(newProductId); dto.setWarehouseId(newWarehouseId);\n\n        Product p \u003d new Product(); p.setId(newProductId);\n        Warehouse w \u003d new Warehouse(); w.setId(newWarehouseId);\n\n        when(inventoryRepository.findById(id)).thenReturn(Optional.of(existing));\n        when(productRepository.findById(newProductId)).thenReturn(Optional.of(p));\n        when(warehouseRepository.findById(newWarehouseId)).thenReturn(Optional.of(w));\n        when(inventoryRepository.save(existing)).thenReturn(existing);\n        when(inventoryMapper.toDTO(existing)).thenReturn(dto);\n\n        var res \u003d service.update(id, dto);\n        assertThat(res).containsEntry(\"message\", \"Inventory updated successfully\");\n        assertThat(res.get(\"inventory\")).isEqualTo(dto);\n    }\n}\npackage com.project.supplychain.services;\n\nimport com.project.supplychain.DTOs.inventoryDTOs.InventoryDTO;\nimport com.project.supplychain.exceptions.BadRequestException;\nimport com.project.supplychain.mappers.InventoryMapper;\nimport com.project.supplychain.models.Inventory;\nimport com.project.supplychain.models.Product;\nimport com.project.supplychain.",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 101
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/SalesOrderServiceTest.java",
      "timestamp": 1763315411036,
      "startOffset": 140,
      "endOffset": 4051,
      "codeContent": "exceptions.BadRequestException;\nimport com.project.supplychain.mappers.SalesOrderMapper;\nimport com.project.supplychain.models.SalesOrder;\nimport com.project.supplychain.models.Warehouse;\nimport com.project.supplychain.models.user.Client;\nimport com.project.supplychain.repositories.InventoryRepository;\nimport com.project.supplychain.repositories.SalesOrderRepository;\nimport com.project.supplychain.repositories.UserRepository;\nimport com.project.supplychain.repositories.WarehouseRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.time.LocalDateTime;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass SalesOrderServiceTest {\n\n    @Mock\n    private SalesOrderRepository salesOrderRepository;\n\n    @Mock\n    private UserRepository userRepository;\n\n    @Mock\n    private WarehouseRepository warehouseRepository;\n\n    @Mock\n    private InventoryRepository inventoryRepository;\n\n    @Mock\n    private SalesOrderMapper salesOrderMapper;\n\n    @InjectMocks\n    private SalesOrderService service;\n\n    @Test\n    void create_success_setsReservedAndReturnsDto() {\n        UUID clientId \u003d UUID.randomUUID();\n        UUID warehouseId \u003d UUID.randomUUID();\n\n        SalesOrderDTO dto \u003d new SalesOrderDTO();\n        dto.setClientId(clientId);\n        dto.setWarehouseId(warehouseId);\n\n        Client client \u003d new Client(); client.setId(clientId);\n        Warehouse w \u003d new Warehouse(); w.setId(warehouseId);\n\n        SalesOrder entity \u003d new SalesOrder();\n        SalesOrder saved \u003d new SalesOrder(); saved.setId(UUID.randomUUID()); saved.setStatus(null); saved.setCreatedAt(LocalDateTime.now());\n\n        when(userRepository.findById(clientId)).thenReturn(Optional.of(client));\n        when(warehouseRepository.getById(warehouseId)).thenReturn(w);\n        when(salesOrderMapper.toEntity(dto)).thenReturn(entity);\n        when(salesOrderRepository.save(entity)).thenReturn(saved);\n        when(salesOrderMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d service.create(dto);\n        assertThat(res).containsEntry(\"message\", \"Sales order created successfully\");\n        assertThat(res).containsKey(\"salesOrder\");\n    }\n\n    @Test\n    void create_missingClient_throws() {\n        SalesOrderDTO dto \u003d new SalesOrderDTO(); dto.setClientId(null);\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"clientId is required\");\n    }\n\n    @Test\n    void create_userNotClient_throws() {\n        UUID clientId \u003d UUID.randomUUID();\n        SalesOrderDTO dto \u003d new SalesOrderDTO(); dto.setClientId(clientId); dto.setWarehouseId(UUID.randomUUID());\n        // return a WarehouseManager instead of Client\n        var wm \u003d new com.project.supplychain.models.user.WarehouseManager(); wm.setId(clientId);\n        when(userRepository.findById(clientId)).thenReturn(Optional.of(wm));\n        assertThatThrownBy(() -\u003e service.create(dto)).isInstanceOf(BadRequestException.class).hasMessageContaining(\"Provided user is not a client\");\n    }\n\n    @Test\n    void delete_existing_deletes() {\n        UUID id \u003d UUID.randomUUID();\n        SalesOrder existing \u003d new SalesOrder(); existing.setId(id);\n        when(salesOrderRepository.findById(id)).thenReturn(Optional.of(existing));\n        var res \u003d service.delete(id);\n        assertThat(res).containsEntry(\"message\", \"Sales order deleted successfully\");\n        verify(salesOrderRepository).delete(existing);\n    }\n}\npackage com.project.supplychain.services;\n\nimport com.project.supplychain.DTOs.salesOrderDTOs.SalesOrderDTO;\nimport com.project.supplychain.",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 100
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/SalesOrderServiceTest.java",
      "timestamp": 1763316132216,
      "startOffset": 2557,
      "endOffset": 5557,
      "codeContent": "package com.project.supplychain.services;\n\n        import com.project.supplychain.DTOs.salesOrderDTOs.SalesOrderDTO;\n        import com.project.supplychain.mappers.SalesOrderMapper;\n        import com.project.supplychain.models.SalesOrder;\n        import com.project.supplychain.models.user.Client;\n        import com.project.supplychain.models.user.User;\n        import com.project.supplychain.models.Warehouse;\n        import com.project.supplychain.repositories.InventoryRepository;\n        import com.project.supplychain.repositories.SalesOrderRepository;\n        import com.project.supplychain.repositories.UserRepository;\n        import com.project.supplychain.repositories.WarehouseRepository;\n        import org.junit.jupiter.api.Test;\n        import org.junit.jupiter.api.extension.ExtendWith;\n        import org.mockito.InjectMocks;\n        import org.mockito.Mock;\n        import org.mockito.junit.jupiter.MockitoExtension;\n\n        import java.time.LocalDateTime;\n        import java.util.Optional;\n        import java.util.UUID;\n\n        import static org.assertj.core.api.Assertions.assertThat;\n        import static org.mockito.ArgumentMatchers.any;\n        import static org.mockito.Mockito.when;\n\n        @ExtendWith(MockitoExtension.class)\n        class SalesOrderServiceTest {\n\n            @Mock\n            private SalesOrderRepository salesOrderRepository;\n\n            @Mock\n            private UserRepository userRepository;\n\n            @Mock\n            private WarehouseRepository warehouseRepository;\n\n            @Mock\n            private InventoryRepository inventoryRepository;\n\n            @Mock\n            private SalesOrderMapper salesOrderMapper;\n\n            @InjectMocks\n            private SalesOrderService salesOrderService;\n\n            @Test\n            void createSalesOrder_success() {\n                UUID clientId \u003d UUID.randomUUID();\n                UUID warehouseId \u003d UUID.randomUUID();\n\n                SalesOrderDTO dto \u003d new SalesOrderDTO();\n                dto.setClientId(clientId);\n                dto.setWarehouseId(warehouseId);\n                dto.setCreatedAt(LocalDateTime.now());\n\n                Client client \u003d new Client();\n                client.setId(clientId);\n\n                SalesOrder toSave \u003d new SalesOrder();\n\n                SalesOrder saved \u003d new SalesOrder();\n                saved.setId(UUID.randomUUID());\n\n                when(userRepository.findById(clientId)).thenReturn(Optional.of((User) client));\n                when(warehouseRepository.getById(warehouseId)).thenReturn(new Warehouse());\n                when(salesOrderMapper.toEntity(dto)).thenReturn(toSave);\n                when(salesOrderRepository.save(any(SalesOrder.class))).thenReturn(saved);\n                when(salesOrderMapper.toDTO(saved)).thenReturn(dto);\n\n                var res \u003d salesOrderService.create(dto);\n                assertThat(res).containsKey(\"message\");\n                assertThat(res).containsKey(\"salesOrder\");\n            }\n        ",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 76
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/SalesOrderServiceTest.java",
      "timestamp": 1763316327559,
      "startOffset": 4108,
      "endOffset": 5153,
      "codeContent": "package com.project.supplychain.services;\n\nimport com.project.supplychain.DTOs.salesOrderDTOs.SalesOrderDTO;\nimport com.project.supplychain.mappers.SalesOrderMapper;\nimport com.project.supplychain.models.SalesOrder;\nimport com.project.supplychain.models.user.Client;\nimport com.project.supplychain.models.user.User;\nimport com.project.supplychain.models.Warehouse;\nimport com.project.supplychain.repositories.InventoryRepository;\nimport com.project.supplychain.repositories.SalesOrderRepository;\nimport com.project.supplychain.repositories.UserRepository;\nimport com.project.supplychain.repositories.WarehouseRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.time.LocalDateTime;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.when;\n",
      "aiProbability": 70,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 26
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/PurchaseOrderServiceUpdateTest.java",
      "timestamp": 1763316850062,
      "startOffset": 602,
      "endOffset": 5081,
      "codeContent": "models.user.Client;\nimport com.project.supplychain.repositories.PurchaseOrderRepository;\nimport com.project.supplychain.repositories.SupplierRepository;\nimport com.project.supplychain.repositories.UserRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.time.LocalDateTime;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.when;\n\n@ExtendWith(MockitoExtension.class)\nclass PurchaseOrderServiceUpdateTest {\n\n    @Mock\n    private PurchaseOrderRepository purchaseOrderRepository;\n\n    @Mock\n    private SupplierRepository supplierRepository;\n\n    @Mock\n    private UserRepository userRepository;\n\n    @Mock\n    private PurchaseOrderMapper purchaseOrderMapper;\n\n    @Mock\n    private PurchaseOrderLineMapper purchaseOrderLineMapper;\n\n    @InjectMocks\n    private PurchaseOrderService purchaseOrderService;\n\n    private PurchaseOrder makePO(UUID id, PurchaseOrderStatus status, UUID supplierId, UUID wmId) {\n        PurchaseOrder po \u003d new PurchaseOrder();\n        po.setId(id);\n        po.setStatus(status);\n        Supplier s \u003d null;\n        if (supplierId !\u003d null) {\n            s \u003d new Supplier();\n            s.setId(supplierId);\n            po.setSupplier(s);\n        }\n        if (wmId !\u003d null) {\n            WarehouseManager wm \u003d new WarehouseManager();\n            wm.setId(wmId);\n            po.setWarehouseManager(wm);\n        }\n        po.setExpectedDelivery(LocalDateTime.now().plusDays(5));\n        return po;\n    }\n\n    @Test\n    void update_success_changes_expectedDelivery_and_supplier_and_manager_when_needed() {\n        UUID poId \u003d UUID.randomUUID();\n        UUID oldSupplierId \u003d UUID.randomUUID();\n        UUID newSupplierId \u003d UUID.randomUUID();\n        UUID oldWmId \u003d UUID.randomUUID();\n        UUID newWmId \u003d UUID.randomUUID();\n\n        PurchaseOrder existing \u003d makePO(poId, PurchaseOrderStatus.CREATED, oldSupplierId, oldWmId);\n\n        PurchaseOrderDTO dto \u003d new PurchaseOrderDTO();\n        dto.setExpectedDelivery(LocalDateTime.now().plusDays(10));\n        dto.setSupplierId(newSupplierId);\n        dto.setWarehouseManagerId(newWmId);\n\n        Supplier newSupplier \u003d new Supplier();\n        newSupplier.setId(newSupplierId);\n\n        WarehouseManager newWm \u003d new WarehouseManager();\n        newWm.setId(newWmId);\n\n        PurchaseOrder saved \u003d makePO(poId, PurchaseOrderStatus.CREATED, newSupplierId, newWmId);\n\n        when(purchaseOrderRepository.findById(poId)).thenReturn(Optional.of(existing));\n        when(supplierRepository.findById(newSupplierId)).thenReturn(Optional.of(newSupplier));\n        when(userRepository.findById(newWmId)).thenReturn(Optional.of((User) newWm));\n        when(purchaseOrderRepository.save(existing)).thenReturn(saved);\n        when(purchaseOrderMapper.toDTO(saved)).thenReturn(new com.project.supplychain.DTOs.purchaseOrderDTOs.PurchaseOrderDTO());\n\n        var res \u003d purchaseOrderService.update(poId, dto);\n\n        assertThat(res).containsKey(\"message\");\n        assertThat(res).containsKey(\"purchaseOrder\");\n    }\n\n    @Test\n    void update_throws_when_supplier_not_found() {\n        UUID poId \u003d UUID.randomUUID();\n        UUID newSupplierId \u003d UUID.randomUUID();\n\n        PurchaseOrder existing \u003d makePO(poId, PurchaseOrderStatus.CREATED, UUID.randomUUID(), UUID.randomUUID());\n\n        PurchaseOrderDTO dto \u003d new PurchaseOrderDTO();\n        dto.setSupplierId(newSupplierId);\n\n        when(purchaseOrderRepository.findById(poId)).thenReturn(Optional.of(existing));\n        when(supplierRepository.findById(newSupplierId)).thenReturn(Optional.empty());\n\n        assertThatThrownBy(() -\u003e purchaseOrderService.update(poId, dto))\n                .isInstanceOf(BadRequestException.class)\n                .hasMessageContaining(\"Supplier not found\");\n    }\n\n    @Test\n    void update_throws_when_user_not_warehouseManager() {\n        UUID poId \u003d UUID.randomUUID();\n        UUID newWmId \u003d UUID.randomUUID();\n\n        PurchaseOrder existing \u003d makePO(poId, PurchaseOrderStatus.CREATED, UUID.randomUUID(), UUID.randomUUID());\n\n        PurchaseOrderDTO dto \u003d new PurchaseOrderDTO();\n        dto.setWarehouseManagerId(newWmId);\n\n    Client notWm \u003d new Client();\n",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 124
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/services/PurchaseOrderServiceFullTest.java",
      "timestamp": 1763317195507,
      "startOffset": 870,
      "endOffset": 4992,
      "codeContent": "models.user.Client;\nimport com.project.supplychain.repositories.PurchaseOrderRepository;\nimport com.project.supplychain.repositories.SupplierRepository;\nimport com.project.supplychain.repositories.UserRepository;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.ArgumentCaptor;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.time.LocalDateTime;\nimport java.util.List;\nimport java.util.Optional;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.assertj.core.api.Assertions.assertThatThrownBy;\nimport static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.*;\n\n@ExtendWith(MockitoExtension.class)\nclass PurchaseOrderServiceFullTest {\n\n    @Mock\n    private PurchaseOrderRepository purchaseOrderRepository;\n\n    @Mock\n    private SupplierRepository supplierRepository;\n\n    @Mock\n    private UserRepository userRepository;\n\n    @Mock\n    private PurchaseOrderMapper purchaseOrderMapper;\n\n    @Mock\n    private PurchaseOrderLineMapper purchaseOrderLineMapper;\n\n    @Mock\n    private InventoryMovementService inventoryMovementService;\n\n    @InjectMocks\n    private PurchaseOrderService purchaseOrderService;\n\n    private PurchaseOrder makePO(UUID id, PurchaseOrderStatus status) {\n        PurchaseOrder po \u003d new PurchaseOrder();\n        po.setId(id);\n        po.setStatus(status);\n        po.setCreatedAt(LocalDateTime.now());\n        po.setExpectedDelivery(LocalDateTime.now().plusDays(3));\n        return po;\n    }\n\n    @Test\n    void create_success_sets_fields_and_returns_dto() {\n        UUID supplierId \u003d UUID.randomUUID();\n        UUID wmId \u003d UUID.randomUUID();\n\n        PurchaseOrderDTO dto \u003d new PurchaseOrderDTO();\n        dto.setSupplierId(supplierId);\n        dto.setWarehouseManagerId(wmId);\n        dto.setExpectedDelivery(LocalDateTime.now().plusDays(7));\n\n        Supplier supplier \u003d new Supplier();\n        supplier.setId(supplierId);\n\n        WarehouseManager wm \u003d new WarehouseManager();\n        wm.setId(wmId);\n\n        PurchaseOrder toSave \u003d new PurchaseOrder();\n        PurchaseOrder saved \u003d makePO(UUID.randomUUID(), PurchaseOrderStatus.CREATED);\n\n        when(supplierRepository.findById(supplierId)).thenReturn(Optional.of(supplier));\n    when(userRepository.findById(wmId)).thenReturn(Optional.of((com.project.supplychain.models.user.User) wm));\n        // userRepository returns a WarehouseManager instance; cast is fine on runtime\n        when(purchaseOrderMapper.toEntity(dto)).thenReturn(toSave);\n        when(purchaseOrderRepository.save(toSave)).thenReturn(saved);\n        when(purchaseOrderMapper.toDTO(saved)).thenReturn(dto);\n\n        var res \u003d purchaseOrderService.create(dto);\n\n        assertThat(res).containsKey(\"message\");\n        assertThat(res).containsKey(\"purchaseOrder\");\n        verify(purchaseOrderRepository).save(toSave);\n    }\n\n    @Test\n    void create_throws_when_supplier_missing_or_user_missing_or_user_not_wm() {\n        UUID supplierId \u003d UUID.randomUUID();\n        UUID wmId \u003d UUID.randomUUID();\n\n        PurchaseOrderDTO dto \u003d new PurchaseOrderDTO();\n        dto.setSupplierId(supplierId);\n        dto.setWarehouseManagerId(wmId);\n\n        when(supplierRepository.findById(supplierId)).thenReturn(Optional.empty());\n        assertThatThrownBy(() -\u003e purchaseOrderService.create(dto))\n                .isInstanceOf(BadRequestException.class)\n                .hasMessageContaining(\"Supplier not found\");\n\n        // supplier found but user missing\n        when(supplierRepository.findById(supplierId)).thenReturn(Optional.of(new Supplier()));\n        when(userRepository.findById(wmId)).thenReturn(Optional.empty());\n        assertThatThrownBy(() -\u003e purchaseOrderService.create(dto))\n                .isInstanceOf(BadRequestException.class)\n                .hasMessageContaining(\"Warehouse manager not found\");\n\n        // user found but not WarehouseManager\n    when(userRepository.findById(wmId)).thenReturn(Optional.of((com.project.supplychain.models.user.User) new Clien",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 110
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/controller/ProductControllerTest.java",
      "timestamp": 1763318076137,
      "startOffset": 56,
      "endOffset": 2082,
      "codeContent": "project.supplychain.DTOs.productDTOs.ProductDTO;\nimport com.project.supplychain.services.ProductService;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\nimport org.springframework.http.ResponseEntity;\n\nimport java.util.HashMap;\nimport java.util.UUID;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.when;\n\n@ExtendWith(MockitoExtension.class)\nclass ProductControllerTest {\n\n    @Mock\n    ProductService service;\n\n    @InjectMocks\n    ProductController controller;\n\n    @Test\n    void create_list_get_byId_get_bySku_update_delete() {\n        when(service.createProduct(any())).thenReturn(new HashMap\u003c\u003e());\n        when(service.listProducts()).thenReturn(new HashMap\u003c\u003e());\n        when(service.getProduct(any())).thenReturn(new HashMap\u003c\u003e());\n        when(service.getProductBySku(any())).thenReturn(new HashMap\u003c\u003e());\n        when(service.updateProduct(any(), any())).thenReturn(new HashMap\u003c\u003e());\n        when(service.deleteProduct(any())).thenReturn(new HashMap\u003c\u003e());\n\n        ResponseEntity\u003c?\u003e r1 \u003d controller.create(new ProductDTO());\n        ResponseEntity\u003c?\u003e r2 \u003d controller.list();\n        ResponseEntity\u003c?\u003e r3 \u003d controller.get(UUID.randomUUID());\n        ResponseEntity\u003c?\u003e r4 \u003d controller.get(\"sku123\");\n        ResponseEntity\u003c?\u003e r5 \u003d controller.update(UUID.randomUUID(), new ProductDTO());\n        ResponseEntity\u003c?\u003e r6 \u003d controller.delete(UUID.randomUUID());\n\n        assertThat(r1.getStatusCodeValue()).isEqualTo(200);\n        assertThat(r2.getStatusCodeValue()).isEqualTo(200);\n        assertThat(r3.getStatusCodeValue()).isEqualTo(200);\n        assertThat(r4.getStatusCodeValue()).isEqualTo(200);\n        assertThat(r5.getStatusCodeValue()).isEqualTo(200);\n        assertThat(r6.getStatusCodeValue()).isEqualTo(200);\n    }\n}\npackage com.project.supplychain.controller;\n\nimport com.",
      "aiProbability": 95,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 52
    },
    {
      "filePath": "S:/Spring Core/Digital Logistics And Supply Chain Platform/src/test/java/com/project/supplychain/DigitalLogisticsAndSupplyChainPlatformApplicationTests.java",
      "timestamp": 1763318626094,
      "startOffset": 130,
      "endOffset": 210,
      "codeContent": "import org.springframework.test.context.ActiveProfiles;\n\n@ActiveProfiles(\"test\")",
      "aiProbability": 90,
      "aiTool": "AI Assistant",
      "detectionMethod": "REALTIME_SPEED_ANALYSIS",
      "lineCount": 3
    }
  ],
  "toolStats": {
    "AI Assistant": {
      "usageCount": 40,
      "totalLines": 1358
    }
  }
}